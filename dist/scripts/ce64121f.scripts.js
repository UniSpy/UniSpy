"use strict";var app=angular.module("uniSpyApp",["ngResource","ui.bootstrap"]);app.config(["$httpProvider",function(a){console.log("!!!1"),console.log(a.defaults.headers),a.defaults.useXDomain=!0,delete a.defaults.headers.common["X-Requested-With"]}]),angular.module("uniSpyApp").controller("MainCtrl",["$scope","$http","$filter",function(a,b){a.days=["Maanantai","Tiistai","Keskiviikko","Torstai","Perjantai","Lauantai","Sunnuntai"];var c=new Date;a.today=c.getDay()-1,b.get("https://unispy-backend.herokuapp.com/menus.json").success(function(b){a.entries=b}),b.get("https://unispy-backend.herokuapp.com/tags.json").success(function(b){a.tags=new Array;for(var c in b)a.tags.push(b[c].content)}),a.taggedOnly=!1,a.shouldDisplay=function(b){return!a.taggedOnly||a.isTagged(b)},a.toggleTagged=function(){a.taggedOnly=!a.taggedOnly},a.hasMeals=function(a){return!!a.length},a.onlyUnicafe=function(a){return void 0===a?!1:a.name.indexOf("Unicafe")>-1},a.onlyUnicafeWithFinnishMeals=function(b){return a.onlyUnicafe(b)&&b.meals.fi.length>0},a.isTagged=function(b){for(var c in a.tags)if(b.toLowerCase().indexOf(a.tags[c].toLowerCase())>-1)return!0;return!1}}]),angular.module("uniSpyApp").controller("SideCtrl",["$scope",function(a){a.isCollapsed=!0,a.tag={},a.addTag=function(){-1==a.tags.indexOf(a.tag.text)&&a.tags.push(a.tag.text),a.tag={}},a.deleteTag=function(b){a.tags.splice(b,1)}}]);var app=angular.module("uniSpyApp");app.factory("Auth",["$http",function(a){var b="http://unispy-backend.herokuapp.com/session",c={};return c.logged={},c.login=function(d){return console.log("Logging in :D"),a.post(b,d).then(function(b){return console.log(d),c.logged.status=!0,c.logged.user=d.user,a.defaults.headers.common["auth-token"]=b.data,b.data})},c.logout=function(){return a.delete(b).then(function(){return c.logged.status=!1,c.logged.user=null,delete a.defaults.headers.common["auth-token"],null})},c}]),angular.module("uniSpyApp").controller("LoginCtrl",["$scope","$modal","Auth",function(a,b,c){a.credentials={},a.loggedIn=c.logged,a.login=function(){console.log(a.credentials),c.login(a.credentials).then(function(){console.log("login success!"),a.$close()},function(){console.log("login fail!"),a.$close()}),a.credentials={}},a.logout=function(){c.logout()},a.open=function(){b.open({templateUrl:"views/login.html",controller:"LoginCtrl",size:"sm"})}}]);